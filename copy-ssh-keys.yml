---
  - name: Create accounts on all nodes
    hosts: nodes
    remote_user: ec2-user 
    become: yes
    tasks:
    - name: Copy private key from duvar to nodes
      file:
         path:  /home/{{item}}/.ssh
         state: directory
         owner: "{{item}}"
         group: "{{item}}"
         mode: '0700'
      loop:
         - talhao
         - numanm
         - cuneytk
         - caglayans
         - ranak
         - huseyink
         - yilmazd
         - turguty
    - name: Copy private key from duvar to nodes
      copy:
         src: /home/ec2-user/account-management/ssh-dirs/{{item}}_sshdir/id_ed25519
         dest: /home/{{item}}/.ssh/
         owner: "{{item}}"
         group: "{{item}}"
         mode: '0600'
      loop:
         - talhao
         - numanm
         - cuneytk
         - caglayans
         - ranak
         - huseyink
         - yilmazd
         - turguty
    - name: Copy public key from duvar to nodes
      copy:
         src: /home/ec2-user/account-management/ssh-dirs/{{item}}_sshdir/id_ed25519.pub
         dest: /home/{{item}}/.ssh/
         owner: "{{item}}"
         group: "{{item}}"
         mode: '0644'
      loop:
         - talhao
         - numanm
         - cuneytk
         - caglayans
         - ranak
         - huseyink
         - yilmazd
         - turguty
    - name: Copy authorized_keys from duvar to nodes 
      copy:
         src:  /home/ec2-user/account-management/ssh-dirs/{{item}}_sshdir/authorized_keys
         dest: /home/{{item}}/.ssh/
         owner: "{{item}}"
         group: "{{item}}"
         mode: '0644'
      loop:
         - talhao
         - numanm
         - cuneytky
         - caglayans
         - ranak
         - huseyink
         - yilmazd
         - turguty
